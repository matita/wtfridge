(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],d=0,p=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={app:0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[n("v-app-bar-nav-icon"),n("v-toolbar-title",[t._v("WTFridge")])],1),n("v-main",{staticClass:"grey lighten-5"},[n("v-container",[t.scanning?n("v-row",[n("v-col",[n("scanner-list")],1)],1):t._e(),n("v-row",[n("v-col",[n("ProductsList",{attrs:{products:t.sortedProducts},on:{delete:t.onDeleteProduct}})],1)],1),n("ProductDialog",{attrs:{visible:t.adding},on:{close:function(e){t.adding=!1},save:t.onSaveProduct}}),n("AddMenu",{on:{"add-click":t.onAddClick,"mic-click":t.onMicClick,"scan-click":t.onScanClick}})],1)],1)],1)},i=[],o=(n("c975"),n("d81d"),n("fb6a"),n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-speed-dial",{staticClass:"speed-dial",attrs:{direction:"top",transition:"slide-y-reverse-transition",fixed:"",right:"",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(){return[n("v-btn",{attrs:{fab:"",primary:"",dark:"",color:"primary"},on:{click:t.onAddClick}},[n("v-icon",[t._v("mdi-plus")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[n("v-btn",{attrs:{fab:"",small:""},on:{click:t.onMicClick}},[n("v-icon",[t._v("mdi-microphone")])],1),n("v-btn",{attrs:{fab:"",small:""},on:{click:t.onScanClick}},[n("v-icon",[t._v("mdi-barcode")])],1)],1)}),c=[],s={data:function(){return{fab:!1}},methods:{onAddClick:function(){this.fab&&this.$emit("add-click")},onMicClick:function(){this.$emit("mic-click")},onScanClick:function(){this.$emit("scan-click")}}},u=s,l=n("2877"),d=n("6544"),p=n.n(d),f=n("8336"),v=n("132d"),m=n("c73b"),h=Object(l["a"])(u,o,c,!1,null,null,null),b=h.exports;p()(h,{VBtn:f["a"],VIcon:v["a"],VSpeedDial:m["a"]});var x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.products.length?n("v-card",[n("transition-group",{attrs:{name:"fade",tag:"div"}},t._l(t.products,(function(e){return n("Product",{key:e.id,attrs:{product:e},on:{delete:function(n){return t.$emit("delete",e)}}})})),1)],1):n("span",[t._v("Nessun prodotto")])},_=[],g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.product.name))]),n("v-list-item-subtitle",{class:{"red--text":t.expired}},[t._v(" "+t._s(t.expiresLabel)+" "+t._s(t.expiry)+" ")])],1),n("v-list-item-action",[n("v-menu",{scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",a,!1),r),[n("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[n("v-list",[n("v-list-item",{on:{click:function(e){return t.$emit("edit",t.product)}}},[t._v("Modifica")]),n("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-list-item",t._g(t._b({},"v-list-item",a,!1),r),[t._v("Elimina")])]}}]),model:{value:t.confirmDelete,callback:function(e){t.confirmDelete=e},expression:"confirmDelete"}},[n("v-card",[n("v-card-title",[t._v(t._s(t.product.name))]),n("v-card-text",[t._v("Confermi la cancellazione?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.confirmDelete=!1}}},[t._v(" No ")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.confirmDelete=!1,t.$emit("delete",t.product)}}},[t._v(" Sì ")])],1)],1)],1)],1)],1)],1)],1)},k=[],y=n("5a0c"),C=n.n(y),V=(n("e4cc"),n("4208")),D=n.n(V);C.a.locale("it"),C.a.extend(D.a);var S={props:["product"],data:function(){return{confirmDelete:!1}},computed:{expireDate:function(){return C()(this.product.expireDate).startOf("day")},expired:function(){return this.expireDate.isBefore(this.today())},expiresLabel:function(){return this.expired?"Scaduto":"Scade"},expiry:function(){return this.today().to(this.expireDate)}},methods:{today:function(){return C()().startOf("day")}}},P=S,w=n("b0af"),O=n("99d9"),$=n("169a"),j=n("8860"),T=n("da13"),I=n("1800"),L=n("5d23"),M=n("e449"),A=n("2fa4"),E=Object(l["a"])(P,g,k,!1,null,null,null),N=E.exports;p()(E,{VBtn:f["a"],VCard:w["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VDialog:$["a"],VIcon:v["a"],VList:j["a"],VListItem:T["a"],VListItemAction:I["a"],VListItemContent:L["a"],VListItemSubtitle:L["b"],VListItemTitle:L["c"],VMenu:M["a"],VSpacer:A["a"]});var B={props:["products"],components:{Product:N}},q=B,F=(n("d85a"),Object(l["a"])(q,x,_,!1,null,null,null)),R=F.exports;p()(F,{VCard:w["a"]});var J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("scanner",{on:{"code-detected":t.onCodeDetected}}),n("v-card-text",t._l(t.products,(function(t,e){return n("scanned-product",{key:e,attrs:{product:t}})})),1),n("v-snackbar",{attrs:{timeout:5e3},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t.lastProduct?n("span",[t.lastProduct.name?n("span",[t._v(" "+t._s(t.lastProduct.name)+" ")]):n("span",[t.lastProduct.searchingCode?n("v-progress-circular",{attrs:{indeterminate:""}}):t._e(),t._v(" "+t._s(t.lastProduct.code)+" ")],1)]):t._e()])],1)},z=[],Q=(n("4de4"),n("a15b"),n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.product.code)+": "+t._s(t.product.name))]),t.product.expireDate?n("v-list-item-subtitle",[t._v(" Expires "+t._s(t.expiry)+" ")]):t._e()],1)],1)}),W=[];C.a.extend(D.a);var G={props:["product"],computed:{expiry:function(){return C()().to(C()(this.product.expireDate))}}},H=G,K=Object(l["a"])(H,Q,W,!1,null,null,null),U=K.exports;p()(K,{VListItem:T["a"],VListItemContent:L["a"],VListItemSubtitle:L["b"],VListItemTitle:L["c"]});var X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"canvas"})},Y=[],Z=(n("a9e3"),n("8a00")),tt=n.n(Z),et={props:{threshold:{type:Number,default:.11},waitMs:{type:Number,default:1e3}},data:function(){return{canDetect:!0}},methods:{onCodeDetected:function(t){var e=this;!this.canDetect||t.codeResult.startInfo.error>this.threshold||(this.canDetect=!1,this.$emit("code-detected",t),setTimeout((function(){return e.canDetect=!0}),this.waitMs))}},mounted:function(){var t=this;tt.a.init({inputStream:{name:"Live",type:"LiveStream",target:this.$el},decoder:{readers:["ean_reader"]}},(function(e){if(e)return console.error(e);tt.a.start(),tt.a.onDetected(t.onCodeDetected)}))},beforeDestroy:function(){tt.a.offDetected(this.onCodeDetected),tt.a.stop()}},nt=et,rt=(n("e132"),Object(l["a"])(nt,X,Y,!1,null,null,null)),at=rt.exports,it=(n("d3b7"),{}),ot=function(t){return new Promise((function(e){return setTimeout(e,t)}))},ct=function(t){if(it[t])return it[t];var e="https://world.openfoodfacts.org/api/v0/product/".concat(t,".json");return it[t]=ot(1e3).then((function(){return fetch(e).then((function(t){return t.json()}))}))},st={components:{Scanner:at,ScannedProduct:U},data:function(){return{snackbar:!1,products:[]}},computed:{lastProduct:function(){return this.products[0]}},methods:{onCodeDetected:function(t){console.log("onCodeDetected",t);var e=t.codeResult.code,n={code:e,name:"",searchingCode:!1};this.products.unshift(n),this.fetchProduct(n),this.snackbar=!0},fetchProduct:function(t){var e=this;t.searchingCode=!0,ct(t.code).then((function(n){t.searchingCode=!1,t.name=e.productName(n.product)}))},productName:function(t){return t?[t.product_name,t.brands].filter((function(t){return!!t})).join(" - "):""}}},ut=st,lt=n("490a"),dt=n("2db4"),pt=Object(l["a"])(ut,J,z,!1,null,null,null),ft=pt.exports;p()(pt,{VCard:w["a"],VCardText:O["b"],VProgressCircular:lt["a"],VSnackbar:dt["a"]});var vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{persistent:"",value:t.visible,"max-width":"600px"}},[n("v-card",[n("v-card-title",[t._v("Aggiungi prodotto")]),n("v-card-text",[n("v-form",{model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",[n("v-text-field",{ref:"name",attrs:{autofocus:"",label:"Nome",rules:t.nameRules},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),n("v-row",[n("v-col",[n("DateField",{model:{value:t.expireDate,callback:function(e){t.expireDate=e},expression:"expireDate"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Quantità","append-icon":"mdi-scale"},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",primary:""},on:{click:t.onCloseClick}},[t._v("Chiudi")]),n("v-btn",{attrs:{text:"",primary:""},on:{click:t.onSaveClick}},[t._v("Salva")])],1)],1)],1)},mt=[],ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scroll-y-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-text-field",t._g(t._b({attrs:{label:"Scadenza","append-icon":"mdi-calendar",readonly:"",value:t.dateString},on:{input:t.onTextInput}},"v-text-field",a,!1),r))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[n("v-date-picker",{attrs:{value:t.dateString,"no-title":""},on:{input:t.onPickerInput}})],1)},bt=[],xt=(n("ac1f"),n("1276"),{props:{value:{type:Date}},data:function(){return{menu:!1}},computed:{dateString:function(){return this.value?this.value.toISOString().split("T")[0]:""}},methods:{onTextInput:function(t){this.$emit("input",new Date(t))},onPickerInput:function(t){this.menu=!1,this.$emit("input",new Date(t))}}}),_t=xt,gt=n("2e4b"),kt=n("8654"),yt=Object(l["a"])(_t,ht,bt,!1,null,null,null),Ct=yt.exports;p()(yt,{VDatePicker:gt["a"],VMenu:M["a"],VTextField:kt["a"]});var Vt={components:{DateField:Ct},props:{visible:{type:Boolean,default:!1}},data:function(){return{name:"",expireDate:null,quantity:0,valid:!1,nameRules:[function(t){return!!t}]}},methods:{onCloseClick:function(){this.$emit("close")},onSaveClick:function(){var t=this.name,e=this.expireDate,n=this.quantity,r=this.valid;r?this.$emit("save",{name:t,expireDate:e,quantity:n}):this.$refs.name.$refs.input.focus()}}},Dt=Vt,St=n("62ad"),Pt=n("a523"),wt=n("4bd4"),Ot=n("0fd9"),$t=Object(l["a"])(Dt,vt,mt,!1,null,null,null),jt=$t.exports;p()($t,{VBtn:f["a"],VCard:w["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VCol:St["a"],VContainer:Pt["a"],VDialog:$["a"],VForm:wt["a"],VRow:Ot["a"],VSpacer:A["a"],VTextField:kt["a"]});var Tt={name:"App",components:{ProductsList:R,ScannerList:ft,AddMenu:b,ProductDialog:jt},data:function(){return{fab:!1,scanning:!1,adding:!1,products:[],maxId:0}},computed:{sortedProducts:function(){return this.products.slice().sort((function(t,e){return t.expireDate.getTime()-e.expireDate.getTime()}))}},methods:{saveList:function(){localStorage["wtfridge_products"]=JSON.stringify(this.products)},onAddClick:function(){this.adding=!0},onMicClick:function(){console.log("mic click")},onScanClick:function(){console.log("scan click"),this.scanning=!this.scanning},onSaveProduct:function(t){this.adding=!1,t.id||(t.id=this.nextId++),this.products.push(t),this.saveList()},onDeleteProduct:function(t){var e=this.products.indexOf(t);e<0||(this.products.splice(e,1),this.saveList())}},mounted:function(){var t=localStorage["wtfridge_products"];t&&(this.products=JSON.parse(t).map((function(t,e){return Object.assign(t,{id:t.id||e,expireDate:new Date(t.expireDate)})})),this.nextId=this.products.length)}},It=Tt,Lt=n("7496"),Mt=n("40dc"),At=n("5bc1"),Et=n("f6c4"),Nt=n("2a7f"),Bt=Object(l["a"])(It,a,i,!1,null,"20c1687c",null),qt=Bt.exports;p()(Bt,{VApp:Lt["a"],VAppBar:Mt["a"],VAppBarNavIcon:At["a"],VCol:St["a"],VContainer:Pt["a"],VMain:Et["a"],VRow:Ot["a"],VToolbarTitle:Nt["a"]});var Ft=n("f309");r["a"].use(Ft["a"]);var Rt=new Ft["a"]({});r["a"].config.productionTip=!1,new r["a"]({vuetify:Rt,render:function(t){return t(qt)}}).$mount("#app")},"5f3b":function(t,e,n){},d85a:function(t,e,n){"use strict";n("f952")},e132:function(t,e,n){"use strict";n("5f3b")},f952:function(t,e,n){}});
//# sourceMappingURL=app.f4f8482a.js.map