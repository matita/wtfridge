(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],d=0,p=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,c=1;c<n.length;c++){var s=n[c];0!==i[s]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/wtfridge/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[n("v-app-bar-nav-icon"),n("v-toolbar-title",[t._v("WTFridge")])],1),n("v-main",{staticClass:"grey lighten-5"},[n("v-container",[t.scanning?n("v-row",[n("v-col",[n("scanner-list")],1)],1):t._e(),n("v-row",[n("v-col",[n("FreeTextProduct")],1)],1),n("v-row",[n("v-col",[n("ProductsList",{attrs:{products:t.sortedProducts},on:{delete:t.onDeleteProduct}})],1)],1),n("ProductDialog",{attrs:{visible:t.adding},on:{close:function(e){t.adding=!1},save:t.onSaveProduct}}),n("AddMenu",{on:{"add-click":t.onAddClick,"mic-click":t.onMicClick,"scan-click":t.onScanClick}})],1)],1)],1)},a=[],o=(n("c975"),n("d81d"),n("fb6a"),n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-speed-dial",{staticClass:"speed-dial",attrs:{direction:"top",transition:"slide-y-reverse-transition",fixed:"",right:"",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(){return[n("v-btn",{attrs:{fab:"",primary:"",dark:"",color:"primary"},on:{click:t.onAddClick}},[n("v-icon",[t._v("mdi-plus")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[n("v-btn",{attrs:{fab:"",small:""},on:{click:t.onMicClick}},[n("v-icon",[t._v("mdi-microphone")])],1),n("v-btn",{attrs:{fab:"",small:""},on:{click:t.onScanClick}},[n("v-icon",[t._v("mdi-barcode")])],1)],1)}),c=[],s={data:function(){return{fab:!1}},methods:{onAddClick:function(){this.fab&&this.$emit("add-click")},onMicClick:function(){this.$emit("mic-click")},onScanClick:function(){this.$emit("scan-click")}}},u=s,l=n("2877"),d=n("6544"),p=n.n(d),f=n("8336"),v=n("132d"),m=n("c73b"),h=Object(l["a"])(u,o,c,!1,null,null,null),b=h.exports;p()(h,{VBtn:f["a"],VIcon:v["a"],VSpeedDial:m["a"]});var x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.products.length?n("v-card",[n("transition-group",{attrs:{name:"fade",tag:"div"}},t._l(t.products,(function(e){return n("Product",{key:e.id,attrs:{product:e},on:{delete:function(n){return t.$emit("delete",e)}}})})),1)],1):n("span",[t._v("Nessun prodotto")])},g=[],_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.product.name))]),n("v-list-item-subtitle",{class:{"red--text":t.expired}},[t._v(" "+t._s(t.expiresLabel)+" "+t._s(t.expiry)+" ")])],1),n("v-list-item-action",[n("v-menu",{scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,i=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",i,!1),r),[n("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[n("v-list",[n("v-list-item",{on:{click:function(e){return t.$emit("edit",t.product)}}},[t._v("Modifica")]),n("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,i=e.attrs;return[n("v-list-item",t._g(t._b({},"v-list-item",i,!1),r),[t._v("Elimina")])]}}]),model:{value:t.confirmDelete,callback:function(e){t.confirmDelete=e},expression:"confirmDelete"}},[n("v-card",[n("v-card-title",[t._v(t._s(t.product.name))]),n("v-card-text",[t._v("Confermi la cancellazione?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.confirmDelete=!1}}},[t._v(" No ")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.confirmDelete=!1,t.$emit("delete",t.product)}}},[t._v(" Sì ")])],1)],1)],1)],1)],1)],1)],1)},k=[],y=n("5a0c"),V=n.n(y),C=(n("e4cc"),n("4208")),D=n.n(C);V.a.locale("it"),V.a.extend(D.a);var S={props:["product"],data:function(){return{confirmDelete:!1}},computed:{expireDate:function(){return V()(this.product.expireDate).startOf("day")},expired:function(){return this.expireDate.isBefore(this.today())},expiresLabel:function(){return this.expired?"Scaduto":"Scade"},expiry:function(){return this.today().to(this.expireDate)}},methods:{today:function(){return V()().startOf("day")}}},w=S,T=n("b0af"),P=n("99d9"),O=n("169a"),j=n("8860"),I=n("da13"),$=n("1800"),L=n("5d23"),M=n("e449"),A=n("2fa4"),E=Object(l["a"])(w,_,k,!1,null,null,null),N=E.exports;p()(E,{VBtn:f["a"],VCard:T["a"],VCardActions:P["a"],VCardText:P["b"],VCardTitle:P["c"],VDialog:O["a"],VIcon:v["a"],VList:j["a"],VListItem:I["a"],VListItemAction:$["a"],VListItemContent:L["a"],VListItemSubtitle:L["b"],VListItemTitle:L["c"],VMenu:M["a"],VSpacer:A["a"]});var R={props:["products"],components:{Product:N}},F=R,B=(n("d85a"),Object(l["a"])(F,x,g,!1,null,null,null)),q=B.exports;p()(B,{VCard:T["a"]});var z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("scanner",{on:{"code-detected":t.onCodeDetected}}),n("v-card-text",t._l(t.products,(function(t,e){return n("scanned-product",{key:e,attrs:{product:t}})})),1),n("v-snackbar",{attrs:{timeout:5e3},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t.lastProduct?n("span",[t.lastProduct.name?n("span",[t._v(" "+t._s(t.lastProduct.name)+" ")]):n("span",[t.lastProduct.searchingCode?n("v-progress-circular",{attrs:{indeterminate:""}}):t._e(),t._v(" "+t._s(t.lastProduct.code)+" ")],1)]):t._e()])],1)},J=[],Q=(n("4de4"),n("a15b"),n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.product.code)+": "+t._s(t.product.name))]),t.product.expireDate?n("v-list-item-subtitle",[t._v(" Expires "+t._s(t.expiry)+" ")]):t._e()],1)],1)}),W=[];V.a.extend(D.a);var Y={props:["product"],computed:{expiry:function(){return V()().to(V()(this.product.expireDate))}}},G=Y,H=Object(l["a"])(G,Q,W,!1,null,null,null),K=H.exports;p()(H,{VListItem:I["a"],VListItemContent:L["a"],VListItemSubtitle:L["b"],VListItemTitle:L["c"]});var U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"canvas"})},X=[],Z=(n("a9e3"),n("8a00")),tt=n.n(Z),et={props:{threshold:{type:Number,default:.11},waitMs:{type:Number,default:1e3}},data:function(){return{canDetect:!0}},methods:{onCodeDetected:function(t){var e=this;!this.canDetect||t.codeResult.startInfo.error>this.threshold||(this.canDetect=!1,this.$emit("code-detected",t),setTimeout((function(){return e.canDetect=!0}),this.waitMs))}},mounted:function(){var t=this;tt.a.init({inputStream:{name:"Live",type:"LiveStream",target:this.$el},decoder:{readers:["ean_reader"]}},(function(e){if(e)return console.error(e);tt.a.start(),tt.a.onDetected(t.onCodeDetected)}))},beforeDestroy:function(){tt.a.offDetected(this.onCodeDetected),tt.a.stop()}},nt=et,rt=(n("e132"),Object(l["a"])(nt,U,X,!1,null,null,null)),it=rt.exports,at=(n("d3b7"),{}),ot=function(t){return new Promise((function(e){return setTimeout(e,t)}))},ct=function(t){if(at[t])return at[t];var e="https://world.openfoodfacts.org/api/v0/product/".concat(t,".json");return at[t]=ot(1e3).then((function(){return fetch(e).then((function(t){return t.json()}))}))},st={components:{Scanner:it,ScannedProduct:K},data:function(){return{snackbar:!1,products:[]}},computed:{lastProduct:function(){return this.products[0]}},methods:{onCodeDetected:function(t){console.log("onCodeDetected",t);var e=t.codeResult.code,n={code:e,name:"",searchingCode:!1};this.products.unshift(n),this.fetchProduct(n),this.snackbar=!0},fetchProduct:function(t){var e=this;t.searchingCode=!0,ct(t.code).then((function(n){t.searchingCode=!1,t.name=e.productName(n.product)}))},productName:function(t){return t?[t.product_name,t.brands].filter((function(t){return!!t})).join(" - "):""}}},ut=st,lt=n("490a"),dt=n("2db4"),pt=Object(l["a"])(ut,z,J,!1,null,null,null),ft=pt.exports;p()(pt,{VCard:T["a"],VCardText:P["b"],VProgressCircular:lt["a"],VSnackbar:dt["a"]});var vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{persistent:"",value:t.visible,"max-width":"600px"}},[n("v-card",[n("v-card-title",[t._v("Aggiungi prodotto")]),n("v-card-text",[n("v-form",{model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-container",[n("v-row",[n("v-col",[n("v-text-field",{ref:"name",attrs:{autofocus:"",label:"Nome",rules:t.nameRules},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),n("v-row",[n("v-col",[n("DateField",{model:{value:t.expireDate,callback:function(e){t.expireDate=e},expression:"expireDate"}})],1),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Quantità","append-icon":"mdi-scale"},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",primary:""},on:{click:t.onCloseClick}},[t._v("Chiudi")]),n("v-btn",{attrs:{text:"",primary:""},on:{click:t.onSaveClick}},[t._v("Salva")])],1)],1)],1)},mt=[],ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scroll-y-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,i=e.attrs;return[n("v-text-field",t._g(t._b({attrs:{label:"Scadenza","append-icon":"mdi-calendar",readonly:"",value:t.dateString},on:{input:t.onTextInput}},"v-text-field",i,!1),r))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[n("v-date-picker",{attrs:{value:t.dateString,"no-title":""},on:{input:t.onPickerInput}})],1)},bt=[],xt=(n("ac1f"),n("1276"),{props:{value:{type:Date}},data:function(){return{menu:!1}},computed:{dateString:function(){return this.value?this.value.toISOString().split("T")[0]:""}},methods:{onTextInput:function(t){this.$emit("input",new Date(t))},onPickerInput:function(t){this.menu=!1,this.$emit("input",new Date(t))}}}),gt=xt,_t=n("2e4b"),kt=n("8654"),yt=Object(l["a"])(gt,ht,bt,!1,null,null,null),Vt=yt.exports;p()(yt,{VDatePicker:_t["a"],VMenu:M["a"],VTextField:kt["a"]});var Ct={components:{DateField:Vt},props:{visible:{type:Boolean,default:!1}},data:function(){return{name:"",expireDate:null,quantity:0,valid:!1,nameRules:[function(t){return!!t}]}},methods:{onCloseClick:function(){this.$emit("close")},onSaveClick:function(){var t=this.name,e=this.expireDate,n=this.quantity,r=this.valid;r?this.$emit("save",{name:t,expireDate:e,quantity:n}):this.$refs.name.$refs.input.focus()}}},Dt=Ct,St=n("62ad"),wt=n("a523"),Tt=n("4bd4"),Pt=n("0fd9"),Ot=Object(l["a"])(Dt,vt,mt,!1,null,null,null),jt=Ot.exports;p()(Ot,{VBtn:f["a"],VCard:T["a"],VCardActions:P["a"],VCardText:P["b"],VCardTitle:P["c"],VCol:St["a"],VContainer:wt["a"],VDialog:O["a"],VForm:Tt["a"],VRow:Pt["a"],VSpacer:A["a"],VTextField:kt["a"]});var It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-textarea",{attrs:{solo:"",value:t.freeText+t.interimText},on:{input:t.onInput}}),n("v-btn",{attrs:{icon:"",disabled:!t.supportsSpeech},on:{click:t.toggleListen}},[t.listening?n("v-icon",[t._v("mdi-stop")]):n("v-icon",[t._v("mdi-microphone")])],1),n("v-row",[n("v-col",[n("div",[t._v("Nome: "+t._s(t.dummy.name))]),n("div",[t._v("Scadenza: "+t._s(t.dummy.expire||"---"))])])],1)],1)},$t=[],Lt=(n("466d"),n("5319"),n("498a"),n("99af"),n("b64b"),n("4d63"),n("25f0"),{primo:1,secondo:2}),Mt={gennaio:1,febbraio:2,marzo:3,aprile:4,maggio:5,giugno:6,luglio:7,agosto:8,settembre:9,ottobre:10,novembre:11,dicembre:12},At=new RegExp(["(?:il\\s*)?","(\\d+|".concat(Object.keys(Lt).join("|"),")"),"[- /]+","(\\d+|".concat(Object.keys(Mt).join("|"),")"),"[- /]+","(\\d+)?\\s*"].join(""));console.log("regexp",At.source);var Et=function(t){console.log("parseDate",t);var e=t.match(At);if(!e)return"nulla";var n=+e[1]||Lt[e[1]],r=+e[2]||Mt[e[2]],i=+e[3];if(isNaN(i)){var a=new Date,o=a.getFullYear(),c=new Date(o,r-1,n);i=c<a?o+1:o}return"".concat(i,"-").concat(r,"-").concat(n)},Nt="webkitSpeechRecognition"in window,Rt=Nt?new window.webkitSpeechRecognition:null;Rt&&(Rt.continuous=!0,Rt.interimResults=!0,Rt.lang="it-IT");var Ft={data:function(){return{listening:!1,freeText:"",interimText:"",dummy:{name:"",expire:""}}},computed:{supportsSpeech:function(){return Nt}},methods:{onInput:function(t){var e=t.toLowerCase(),n=e.match(/\bscad(?:e|ono)\s+(.*)/);n&&(e=e.replace(n[0],""),this.dummy.expire=Et(n[1])),this.freeText=t,this.dummy.name=e.trim()},toggleListen:function(){var t=this;this.listening?(this.listening=!1,Rt.stop()):(this.listening=!0,this.freeText="",Rt.onend=function(){t.listening&&(t.freeText="",Rt.start())},Rt.onresult=function(e){t.interimText="";for(var n=e.resultIndex;n<e.results.length;n++){var r=e.results[n];console.log("result",r);var i=r[0].transcript;r.isFinal?t.freeText+=i:t.interimText+=i}t.onInput(t.freeText)},Rt.start())}}},Bt=Ft,qt=n("a844"),zt=Object(l["a"])(Bt,It,$t,!1,null,null,null),Jt=zt.exports;p()(zt,{VBtn:f["a"],VCol:St["a"],VIcon:v["a"],VRow:Pt["a"],VTextarea:qt["a"]});var Qt={name:"App",components:{ProductsList:q,ScannerList:ft,AddMenu:b,ProductDialog:jt,FreeTextProduct:Jt},data:function(){return{fab:!1,scanning:!1,adding:!1,products:[],maxId:0}},computed:{sortedProducts:function(){return this.products.slice().sort((function(t,e){return t.expireDate.getTime()-e.expireDate.getTime()}))}},methods:{saveList:function(){localStorage["wtfridge_products"]=JSON.stringify(this.products)},onAddClick:function(){this.adding=!0},onMicClick:function(){console.log("mic click")},onScanClick:function(){console.log("scan click"),this.scanning=!this.scanning},onSaveProduct:function(t){this.adding=!1,t.id||(t.id=this.nextId++),this.products.push(t),this.saveList()},onDeleteProduct:function(t){var e=this.products.indexOf(t);e<0||(this.products.splice(e,1),this.saveList())}},mounted:function(){var t=localStorage["wtfridge_products"];t&&(this.products=JSON.parse(t).map((function(t,e){return Object.assign(t,{id:t.id||e,expireDate:new Date(t.expireDate)})})),this.nextId=this.products.length)}},Wt=Qt,Yt=n("7496"),Gt=n("40dc"),Ht=n("5bc1"),Kt=n("f6c4"),Ut=n("2a7f"),Xt=Object(l["a"])(Wt,i,a,!1,null,"32641e9f",null),Zt=Xt.exports;p()(Xt,{VApp:Yt["a"],VAppBar:Gt["a"],VAppBarNavIcon:Ht["a"],VCol:St["a"],VContainer:wt["a"],VMain:Kt["a"],VRow:Pt["a"],VToolbarTitle:Ut["a"]});var te=n("f309");r["a"].use(te["a"]);var ee=new te["a"]({});r["a"].config.productionTip=!1,new r["a"]({vuetify:ee,render:function(t){return t(Zt)}}).$mount("#app")},"5f3b":function(t,e,n){},d85a:function(t,e,n){"use strict";n("f952")},e132:function(t,e,n){"use strict";n("5f3b")},f952:function(t,e,n){}});
//# sourceMappingURL=app.86f1224a.js.map